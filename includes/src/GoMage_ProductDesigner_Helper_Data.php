<?php eval(base64_decode("LyoqICogR29NYWdlIFByb2R1Y3QgRGVzaWduZXIgRXh0ZW5zaW9uICogKiBAY2F0ZWdvcnkgRXh0ZW5zaW9uICogQGNvcHlyaWdodCBDb3B5cmlnaHQgKGMpIDIwMTMgR29NYWdlIChodHRwOi8vd3d3LmdvbWFnZS5jb20pICogQGF1dGhvciBHb01hZ2UgKiBAbGljZW5zZSBodHRwOi8vd3d3LmdvbWFnZS5jb20vbGljZW5zZS1hZ3JlZW1lbnQvIFNpbmdsZSBkb21haW4gbGljZW5zZSAqIEB0ZXJtcyBvZiB1c2UgaHR0cDovL3d3dy5nb21hZ2UuY29tL3Rlcm1zLW9mLXVzZS8gKiBAdmVyc2lvbiBSZWxlYXNlOiAxLjAuMCAqIEBzaW5jZSBBdmFpbGFibGUgc2luY2UgUmVsZWFzZSAxLjAuMCAqLyAvKiogKiBEZXNpZ25lciBoZWxwZXIgKiAqIEBjYXRlZ29yeSBHb01hZ2UgKiBAcGFja2FnZSBHb01hZ2VfUHJvZHVjdERlc2lnbmVyICogQHN1YnBhY2thZ2UgSGVscGVyICogQGF1dGhvciBSb21hbiBCdWJsaWsgPHJiQGdvbWFnZS5jb20+ICovIGNsYXNzIEdvTWFnZV9Qcm9kdWN0RGVzaWduZXJfSGVscGVyX0RhdGEgZXh0ZW5kcyBNYWdlX0NvcmVfSGVscGVyX0Fic3RyYWN0IHsgY29uc3QgQURWQU5DRURfTkFWSUdBVElPTl9NT0RVTEVfTkFNRSA9ICdHb01hZ2VfTmF2aWdhdGlvbic7IHByb3RlY3RlZCAkX2FsbG93ZWRQcm9kdWN0VHlwZXMgPSBhcnJheSggTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3RfVHlwZTo6VFlQRV9TSU1QTEUsIE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0X1R5cGU6OlRZUEVfQ09ORklHVVJBQkxFICk7IHByb3RlY3RlZCAkX3Byb2R1Y3RTZXR0aW5nczsgcHJvdGVjdGVkICRfcHJvZHVjdERlc2lnbiA9IG51bGw7IHByb3RlY3RlZCAkX2VkaXRvckNvbmZpZyA9IG51bGw7IHB1YmxpYyBmdW5jdGlvbiBpc0VuYWJsZWQoKSB7IHJldHVybiBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2Rlc2lnbmVyL2dlbmVyYWwvZW5hYmxlZCcsIE1hZ2U6OmFwcCgpLT5nZXRTdG9yZSgpKTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNOYXZpZ2F0aW9uRW5hYmxlZCgpIHsgcmV0dXJuIE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfZGVzaWduZXIvbmF2aWdhdGlvbi9lbmFibGVkJywgTWFnZTo6YXBwKCktPmdldFN0b3JlKCkpOyB9IHB1YmxpYyBmdW5jdGlvbiBhZHZhbmNlZE5hdmlnYXRpb25FbmFibGVkKCkgeyAkbW9kdWxlcyA9IChhcnJheSkgTWFnZTo6Z2V0Q29uZmlnKCktPmdldE5vZGUoJ21vZHVsZXMnKS0+Y2hpbGRyZW4oKTsgaWYgKGlzc2V0KCRtb2R1bGVzW3NlbGY6OkFEVkFOQ0VEX05BVklHQVRJT05fTU9EVUxFX05BTUVdKSkgeyAkbW9kdWxlID0gJG1vZHVsZXNbc2VsZjo6QURWQU5DRURfTkFWSUdBVElPTl9NT0RVTEVfTkFNRV07IHJldHVybiAkbW9kdWxlLT5pcygnYWN0aXZlJykgJiYgTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9uYXZpZ2F0aW9uL2dlbmVyYWwvbW9kZScpOyB9IHJldHVybiBmYWxzZTsgfSBwdWJsaWMgZnVuY3Rpb24gaXNFbnRlcnByaXNlRWRpdGlvbigpIHsgJG1vZHVsZXMgPSAoYXJyYXkpIE1hZ2U6OmdldENvbmZpZygpLT5nZXROb2RlKCdtb2R1bGVzJyktPmNoaWxkcmVuKCk7IHJldHVybiBpc3NldCgkbW9kdWxlc1snRW50ZXJwcmlzZV9UYXJnZXRSdWxlJ10pOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRJc0FueW1vcmVWZXJzaW9uKCRtYWpvciwgJG1pbm9yLCAkcmV2aXNpb24gPSAwKSB7ICR2ZXJzaW9uX2luZm8gPSBNYWdlOjpnZXRWZXJzaW9uSW5mbygpOyBpZiAoJHZlcnNpb25faW5mb1snbWFqb3InXSA+ICRtYWpvcikgeyByZXR1cm4gdHJ1ZTsgfSBlbHNlaWYgKCR2ZXJzaW9uX2luZm9bJ21ham9yJ10gPT0gJG1ham9yKSB7IGlmICgkdmVyc2lvbl9pbmZvWydtaW5vciddID4gJG1pbm9yKSB7IHJldHVybiB0cnVlOyB9IGVsc2VpZiAoJHZlcnNpb25faW5mb1snbWlub3InXSA9PSAkbWlub3IpIHsgaWYgKCR2ZXJzaW9uX2luZm9bJ3JldmlzaW9uJ10gPj0gJHJldmlzaW9uKSB7IHJldHVybiB0cnVlOyB9IH0gfSByZXR1cm4gZmFsc2U7IH0gLyoqICogUmV0dXJuIGFsbG93ZWQgcHJvZHVjdCB0eXBlcyAqICogQHJldHVybiBhcnJheSAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0QWxsb3dlZFByb2R1Y3RUeXBlcygpIHsgcmV0dXJuICR0aGlzLT5fYWxsb3dlZFByb2R1Y3RUeXBlczsgfSBwdWJsaWMgZnVuY3Rpb24gaGFzQ29sb3JBdHRyaWJ1dGUoKSB7ICRhdHRyaWJ1dGVDb2RlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9kZXNpZ25lci9uYXZpZ2F0aW9uL2NvbG9yX2F0dHJpYnV0ZScpOyAkYXR0cmlidXRlID0gTWFnZTo6Z2V0U2luZ2xldG9uKCdlYXYvY29uZmlnJykgLT5nZXRBdHRyaWJ1dGUoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3Q6OkVOVElUWSwgJGF0dHJpYnV0ZUNvZGUpOyByZXR1cm4gJGF0dHJpYnV0ZS0+Z2V0SWQoKTsgfSAvKiogKiBSZXR1cm4gSW1hZ2UgU2V0dGluZ3MgKiAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCBQcm9kdWN0ICogQHBhcmFtIGludCAkaW1hZ2VJZCBJbWFnZSBJZCAqIEByZXR1cm4gYm9vbGVhbnxhcnJheSAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0SW1hZ2VTZXR0aW5ncyhNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCwgJGltYWdlSWQpIHsgJHNldHRpbmdzID0gJHRoaXMtPmdldFNldHRpbmdzKCRwcm9kdWN0KTsgaWYgKGlzc2V0KCRzZXR0aW5nc1skaW1hZ2VJZF0pKSB7IHJldHVybiAkc2V0dGluZ3NbJGltYWdlSWRdOyB9IHJldHVybiBmYWxzZTsgfSAvKiogKiBSZXR1cm4gUHJvZHVjdCBpbWFnZXMgc2V0dGluZ3MgKiAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCBQcm9kdWN0ICogQHJldHVybiBhcnJheSAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0U2V0dGluZ3MoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QpIHsgaWYgKCEkdGhpcy0+X3Byb2R1Y3RTZXR0aW5ncykgeyAkc2V0dGluZ3MgPSBhcnJheSgpOyAkaW1hZ2VzID0gJHByb2R1Y3QtPmdldE1lZGlhR2FsbGVyeSgnaW1hZ2VzJyk7IGZvcmVhY2ggKCRpbWFnZXMgYXMgJGltYWdlKSB7ICRkZXNpZ25BcmVhID0gTWFnZTo6aGVscGVyKCdjb3JlJyktPmpzb25EZWNvZGUoJGltYWdlWydkZXNpZ25fYXJlYSddKTsgJGltYWdlSWQgPSAkaW1hZ2VbJ3ZhbHVlX2lkJ107IGlmICgkZGVzaWduQXJlYSAmJiAhZW1wdHkoJGRlc2lnbkFyZWEpKSB7ICRpbWFnZVVybCA9ICR0aGlzLT5nZXREZXNpZ25JbWFnZVVybCgkcHJvZHVjdCwgJGltYWdlKTsgJGRpbWVuc2lvbnMgPSAkdGhpcy0+Z2V0SW1hZ2VEaW1lbnNpb25zKCRpbWFnZVVybCk7ICRiYXNlVXJsID0gTWFnZTo6Z2V0QmFzZVVybCgnbWVkaWEnKTsgJGJhc2VEaXIgPSBNYWdlOjpnZXRCYXNlRGlyKCdtZWRpYScpIC4gRFM7ICRkZXNpZ25BcmVhWydwYXRoJ10gPSBzdHJfcmVwbGFjZSgkYmFzZVVybCwgJGJhc2VEaXIsICRpbWFnZVVybCk7ICRkZXNpZ25BcmVhWydkaW1lbnNpb25zJ10gPSBhcnJheSggJ3dpZHRoJyA9PiAkZGltZW5zaW9uc1swXSwgJ2hlaWdodCcgPT4gJGRpbWVuc2lvbnNbMV0gKTsgJGRlc2lnbkFyZWFbJ29yaWdpbmFsX2ltYWdlJ10gPSAkdGhpcy0+Z2V0T3JpZ2luYWxJbWFnZSgkcHJvZHVjdCwgJGltYWdlKTsgaWYgKGlzc2V0KCRkZXNpZ25BcmVhWydvcmlnaW5hbF9pbWFnZSddWyd1cmwnXSkpIHsgJGRlc2lnbkFyZWFbJ29yaWdpbmFsX2ltYWdlJ11bJ3BhdGgnXSA9IHN0cl9yZXBsYWNlKCAkYmFzZVVybCwgJGJhc2VEaXIsICRkZXNpZ25BcmVhWydvcmlnaW5hbF9pbWFnZSddWyd1cmwnXSApOyB9ICRzZXR0aW5nc1skaW1hZ2VJZF0gPSAkZGVzaWduQXJlYTsgfSB9ICR0aGlzLT5fcHJvZHVjdFNldHRpbmdzID0gJHNldHRpbmdzOyB9IHJldHVybiAkdGhpcy0+X3Byb2R1Y3RTZXR0aW5nczsgfSBwdWJsaWMgZnVuY3Rpb24ganNvbkRlY29kZSgkc3RyaW5nKSB7ICRzZXR0aW5ncyA9IE1hZ2U6OmhlbHBlcignY29yZScpLT5qc29uRGVjb2RlKCRzdHJpbmcpOyAkdG1wID0gYXJyYXkoKTsgZm9yZWFjaCAoJHNldHRpbmdzIGFzICRpID0+ICR2KSB7ICR0bXBbJGldID0gKGFycmF5KSR2OyBpZiAoIWlzc2V0KCR0bXBbJGldWydzJ10pKSB7ICR0bXBbJGldWydzJ10gPSAxOyB9IH0gJHNldHRpbmdzID0gJHRtcDsgcmV0dXJuICRzZXR0aW5nczsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0SW1hZ2VEaW1lbnNpb25zKCRpbWFnZVBhdGgpIHsgJGRpckltZyA9IE1hZ2U6OmdldEJhc2VEaXIoKS5zdHJfcmVwbGFjZSgiLyIsIERTLCBzdHJzdHIoJGltYWdlUGF0aCwgJy9tZWRpYScpKTsgaWYgKGZpbGVfZXhpc3RzKCRkaXJJbWcpKSB7ICRpbWFnZU9iaiA9IG5ldyBWYXJpZW5fSW1hZ2UoJGRpckltZyk7ICR3aWR0aCA9ICRpbWFnZU9iai0+Z2V0T3JpZ2luYWxXaWR0aCgpOyAkaGVpZ2h0ID0gJGltYWdlT2JqLT5nZXRPcmlnaW5hbEhlaWdodCgpOyByZXR1cm4gYXJyYXkoJHdpZHRoLCAkaGVpZ2h0KTsgfSByZXR1cm4gYXJyYXkoMCwgMCk7IH0gcHVibGljIGZ1bmN0aW9uIHByZXBhcmVEZXNpZ25lclNlc3Npb25JZCgpIHsgJGN1c3RvbWVyU2Vzc2lvbiA9ICR0aGlzLT5fZ2V0Q3VzdG9tZXJTZXNzaW9uKCk7IGlmKCEkY3VzdG9tZXJTZXNzaW9uLT5nZXREZXNpZ25lclNlc3Npb25JZCgpKSB7ICRjdXN0b21lclNlc3Npb24tPnNldERlc2lnbmVyU2Vzc2lvbklkKHNoYTEocmFuZCgwLDEwMDApLm1pY3JvdGltZSh0cnVlKSkpOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldERlc2lnbmVyU2Vzc2lvbklkKCkgeyAkc2Vzc2lvbklkID0gJHRoaXMtPl9nZXRDdXN0b21lclNlc3Npb24oKS0+Z2V0RW5jcnlwdGVkU2Vzc2lvbklkKCk7IHJldHVybiAkc2Vzc2lvbklkOyB9IHByb3RlY3RlZCBmdW5jdGlvbiBfZ2V0Q3VzdG9tZXJTZXNzaW9uKCkgeyByZXR1cm4gTWFnZTo6Z2V0U2luZ2xldG9uKCdjdXN0b21lci9zZXNzaW9uJyk7IH0gcHVibGljIGZ1bmN0aW9uIGdldERlc2lnbldpZHRoKCkgeyByZXR1cm4gR29NYWdlX1Byb2R1Y3REZXNpZ25lcl9Nb2RlbF9EZXNpZ246OkRFU0lHTl9TSVpFX1dJRFRIOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXREZXNpZ25IZWlnaHQoKSB7IHJldHVybiBHb01hZ2VfUHJvZHVjdERlc2lnbmVyX01vZGVsX0Rlc2lnbjo6REVTSUdOX1NJWkVfSEVJR0hUOyB9IC8qKiAqIFJldHVybiBJbWFnZSBVcmwgKiAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCBQcm9kdWN0ICogQHBhcmFtIFZhcmllbl9PYmplY3QgJGltYWdlIEltYWdlICogQHBhcmFtIGFycmF5ICRzaXplIFNpemUgKiBAcmV0dXJuIHN0cmluZyAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0RGVzaWduSW1hZ2VVcmwoTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3QgJHByb2R1Y3QsICRpbWFnZSwgJHNpemUgPSBhcnJheSgpKSB7IGlmIChlbXB0eSgkc2l6ZSkpIHsgJGltYWdlV2lkdGggPSBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9kZXNpZ25lcicpLT5nZXREZXNpZ25XaWR0aCgpOyAkaW1hZ2VIZWlnaHQgPSBNYWdlOjpoZWxwZXIoJ2dvbWFnZV9kZXNpZ25lcicpLT5nZXREZXNpZ25IZWlnaHQoKTsgfSBlbHNlIHsgbGlzdCgkaW1hZ2VXaWR0aCwgJGltYWdlSGVpZ2h0KSA9ICRzaXplOyB9ICRpbWFnZUZpbGUgPSBpc19vYmplY3QoJGltYWdlKSA/ICRpbWFnZS0+Z2V0RmlsZSgpIDogJGltYWdlWydmaWxlJ107ICR1cmwgPSBNYWdlOjpoZWxwZXIoJ2NhdGFsb2cvaW1hZ2UnKS0+aW5pdCgkcHJvZHVjdCwgJ2Jhc2VfaW1hZ2UnLCAkaW1hZ2VGaWxlKS0+a2VlcEZyYW1lKGZhbHNlKSAtPnJlc2l6ZSgkaW1hZ2VXaWR0aCwgJGltYWdlSGVpZ2h0KS0+X190b1N0cmluZygpOyByZXR1cm4gJHVybDsgfSBwdWJsaWMgZnVuY3Rpb24gZ2V0T3JpZ2luYWxJbWFnZShNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCwgJGltYWdlKSB7ICRpbWFnZUZpbGUgPSBpc19vYmplY3QoJGltYWdlKSA/ICRpbWFnZS0+Z2V0RmlsZSgpIDogJGltYWdlWydmaWxlJ107ICRpbWFnZVBhdGggPSAkcHJvZHVjdC0+Z2V0TWVkaWFDb25maWcoKS0+Z2V0TWVkaWFQYXRoKCRpbWFnZUZpbGUpOyAkbWluV2lkdGggPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2Rlc2lnbmVyL2dlbmVyYWwvem9vbV9zaXplX3dpZHRoJyk7ICRtaW5IZWlnaHQgPSBNYWdlOjpnZXRTdG9yZUNvbmZpZygnZ29tYWdlX2Rlc2lnbmVyL2dlbmVyYWwvem9vbV9zaXplX2hlaWdodCcpOyBpZiAoZmlsZV9leGlzdHMoJGltYWdlUGF0aCkpIHsgJGltYWdlT2JqID0gbmV3IFZhcmllbl9JbWFnZSgkaW1hZ2VQYXRoKTsgJHdpZHRoID0gJGltYWdlT2JqLT5nZXRPcmlnaW5hbFdpZHRoKCk7ICRoZWlnaHQgPSAkaW1hZ2VPYmotPmdldE9yaWdpbmFsSGVpZ2h0KCk7ICRkaW1lbnNpb25zID0gYXJyYXkoKTsgaWYgKCR3aWR0aCA8ICRtaW5XaWR0aCAmJiAkaGVpZ2h0IDwgJG1pbkhlaWdodCkgeyAkZGltZW5zaW9uc1swXSA9ICRtaW5XaWR0aDsgJGRpbWVuc2lvbnNbMV0gPSAkbWluSGVpZ2h0OyB9IGVsc2UgeyAkZGltZW5zaW9uc1swXSA9ICR3aWR0aDsgJGRpbWVuc2lvbnNbMV0gPSAkaGVpZ2h0OyB9IHJldHVybiBhcnJheSggJ3VybCcgPT4gJHRoaXMtPmdldERlc2lnbkltYWdlVXJsKCRwcm9kdWN0LCAkaW1hZ2UsICRkaW1lbnNpb25zKSwgJ2RpbWVuc2lvbnMnID0+ICRkaW1lbnNpb25zICk7IH0gcmV0dXJuIGFycmF5KCk7IH0gcHVibGljIGZ1bmN0aW9uIGdldFByb2R1Y3RTZXR0aW5nRm9yRWRpdG9yKE1hZ2VfQ2F0YWxvZ19Nb2RlbF9Qcm9kdWN0ICRwcm9kdWN0ID0gbnVsbCkgeyBpZiAoISR0aGlzLT5fZWRpdG9yQ29uZmlnKSB7IGlmIChpc19udWxsKCRwcm9kdWN0KSkgeyAkcHJvZHVjdCA9IE1hZ2U6OnJlZ2lzdHJ5KCdwcm9kdWN0Jyk7IH0gJGVkaXRvckNvbmZpZyA9IGFycmF5KCAnaW1hZ2VzJyA9PiBhcnJheSgpICk7IGlmICghJHByb2R1Y3QtPmdldElkKCkpIHsgcmV0dXJuICRlZGl0b3JDb25maWc7IH0gJGltYWdlcyA9ICRwcm9kdWN0LT5nZXRNZWRpYUdhbGxlcnkoJ2ltYWdlcycpOyAkY29sb3JBdHRyaWJ1dGVDb2RlID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9kZXNpZ25lci9uYXZpZ2F0aW9uL2NvbG9yX2F0dHJpYnV0ZScpOyAkZGVmYXVsdENvbG9yID0gbnVsbDsgZm9yZWFjaCAoJGltYWdlcyBhcyAkaW1hZ2UpIHsgJGlkID0gJGltYWdlWyd2YWx1ZV9pZCddOyAkc2V0dGluZ3MgPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+anNvbkRlY29kZSgkaW1hZ2VbJ2Rlc2lnbl9hcmVhJ10pOyBpZiAoISRzZXR0aW5ncyB8fCBlbXB0eSgkc2V0dGluZ3MpKSB7IGNvbnRpbnVlOyB9ICRpbWFnZVVybCA9ICR0aGlzLT5nZXREZXNpZ25JbWFnZVVybCgkcHJvZHVjdCwgJGltYWdlKTsgJGNvbmYgPSAkc2V0dGluZ3M7ICRjb25mWydpZCddID0gJGlkOyAkY29uZlsndSddID0gJGltYWdlVXJsOyAkY29uZlsnZCddID0gJHRoaXMtPmdldEltYWdlRGltZW5zaW9ucygkaW1hZ2VVcmwpOyAkY29uZlsnb3JpZ19pbWFnZSddID0gJHRoaXMtPmdldE9yaWdpbmFsSW1hZ2UoJHByb2R1Y3QsICRpbWFnZSk7IGlmICgkcHJvZHVjdC0+Z2V0VHlwZUlkKCkgPT0gTWFnZV9DYXRhbG9nX01vZGVsX1Byb2R1Y3RfVHlwZTo6VFlQRV9DT05GSUdVUkFCTEUpIHsgaWYgKCRpbWFnZVsnY29sb3InXSkgeyBpZiAoaXNfbnVsbCgkZGVmYXVsdENvbG9yKSkgeyAkZGVmYXVsdENvbG9yID0gJGltYWdlWydjb2xvciddOyB9IGlmICghaXNzZXQoJGVkaXRvckNvbmZpZ1snaW1hZ2VzJ11bJGltYWdlWydjb2xvciddXSkpIHsgJGVkaXRvckNvbmZpZ1snaW1hZ2VzJ11bJGltYWdlWydjb2xvciddXSA9IGFycmF5KCk7IH0gJGVkaXRvckNvbmZpZ1snaW1hZ2VzJ11bJGltYWdlWydjb2xvciddXVskaWRdID0gJGNvbmY7IH0gZWxzZSB7ICRkZWZhdWx0Q29sb3IgPSAkcHJvZHVjdC0+Z2V0RGF0YSgkY29sb3JBdHRyaWJ1dGVDb2RlKSA/Oidub25lX2NvbG9yJzsgJGVkaXRvckNvbmZpZ1snaW1hZ2VzJ11bJGRlZmF1bHRDb2xvcl1bJGlkXSA9ICRjb25mOyB9IH0gZWxzZSB7ICRkZWZhdWx0Q29sb3IgPSAnbm9uZV9jb2xvcic7ICRlZGl0b3JDb25maWdbJ2ltYWdlcyddWyRkZWZhdWx0Q29sb3JdWyRpZF0gPSAkY29uZjsgfSAkZWRpdG9yQ29uZmlnWydkZWZhdWx0X2NvbG9yJ10gPSAkZGVmYXVsdENvbG9yOyAkZWRpdG9yQ29uZmlnWyd1cmwnXSA9ICRwcm9kdWN0LT5nZXRQcm9kdWN0VXJsKCk7IH0gJHRoaXMtPl9lZGl0b3JDb25maWcgPSAkZWRpdG9yQ29uZmlnOyB9IHJldHVybiAkdGhpcy0+X2VkaXRvckNvbmZpZzsgfSAvKiogKiBTYXZlIHByb2R1Y3QgZGVzaWduIGltYWdlcyAqICogQHJldHVybiBHb01hZ2VfUHJvZHVjdERlc2lnbmVyX01vZGVsX0Rlc2lnbiAqIEB0aHJvd3MgRXhjZXB0aW9uICovIHB1YmxpYyBmdW5jdGlvbiBzYXZlUHJvZHVjdERlc2lnbmVkSW1hZ2VzKCkgeyAkcHJvZHVjdCA9ICR0aGlzLT5pbml0aWFsaXplUHJvZHVjdCgpOyAkaW1hZ2VzID0gTWFnZTo6YXBwKCktPmdldFJlcXVlc3QoKS0+Z2V0UGFyYW0oJ2ltYWdlcycpOyBpZiAoJHByb2R1Y3QtPmdldElkKCkgJiYgJGltYWdlcyAmJiAhZW1wdHkoJGltYWdlcykpIHsgJGRlc2lnbiA9IE1hZ2U6OmdldE1vZGVsKCdnb21hZ2VfZGVzaWduZXIvZGVzaWduJyktPnNhdmVEZXNpZ24oJHByb2R1Y3QsICR0aGlzLT5fZ2V0UmVxdWVzdCgpLT5nZXRQYXJhbXMoKSk7IHJldHVybiAkZGVzaWduOyB9IGVsc2VpZighJHByb2R1Y3QtPmdldElkKCkpIHsgdGhyb3cgbmV3IEV4Y2VwdGlvbihNYWdlOjpoZWxwZXIoJ2dvbWFnZV9kZXNpZ25lcicpLT5fXygnUHJvZHVjdCBpcyBub3QgZGVmaW5lZCcpKTsgfSBlbHNlaWYoISRpbWFnZXMgfHwgZW1wdHkoJGltYWdlcykpIHsgdGhyb3cgbmV3IEV4Y2VwdGlvbihNYWdlOjpoZWxwZXIoJ2dvbWFnZV9kZXNpZ25lcicpLT5fXygnRGVzaWduZWQgaW1hZ2VzIGFyZSBlbXB0eScpKTsgfSB9IC8qKiAqIEluaXRpYWxpemUgY3VycmVudCBwcm9kdWN0IGZyb20gcmVxdWVzdCAqICogQHJldHVybiBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAqLyBwdWJsaWMgZnVuY3Rpb24gaW5pdGlhbGl6ZVByb2R1Y3QoKSB7ICRwcm9kdWN0ID0gTWFnZTo6cmVnaXN0cnkoJ3Byb2R1Y3QnKTsgaWYgKCRwcm9kdWN0KSB7IHJldHVybiAkcHJvZHVjdDsgfSAkcmVxdWVzdCA9IE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCk7ICRwcm9kdWN0SWQgPSAkcmVxdWVzdC0+Z2V0UGFyYW0oImlkIiwgZmFsc2UpOyAkcHJvZHVjdCA9IE1hZ2U6OmdldE1vZGVsKCdjYXRhbG9nL3Byb2R1Y3QnKTsgaWYgKCRwcm9kdWN0SWQpIHsgJHByb2R1Y3QtPmxvYWQoJHByb2R1Y3RJZCk7IH0gTWFnZTo6cmVnaXN0ZXIoJ3Byb2R1Y3QnLCAkcHJvZHVjdCk7IHJldHVybiAkcHJvZHVjdDsgfSAvKiogKiBQcmljZSBjYWxjdWxhdGlvbiBkZXBlbmRpbmcgb24gcHJvZHVjdCBvcHRpb25zICogKiBAcmV0dXJuIGFycmF5ICovIHB1YmxpYyBmdW5jdGlvbiBnZXRQcm9kdWN0UHJpY2VDb25maWcoKSB7ICRjb25maWcgPSBhcnJheSgpOyAkX3JlcXVlc3QgPSBNYWdlOjpnZXRTaW5nbGV0b24oJ3RheC9jYWxjdWxhdGlvbicpLT5nZXRSYXRlUmVxdWVzdChmYWxzZSwgZmFsc2UsIGZhbHNlKTsgLyogQHZhciAkcHJvZHVjdCBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAqLyAkcHJvZHVjdCA9ICR0aGlzLT5pbml0aWFsaXplUHJvZHVjdCgpOyAkX3JlcXVlc3QtPnNldFByb2R1Y3RDbGFzc0lkKCRwcm9kdWN0LT5nZXRUYXhDbGFzc0lkKCkpOyAkZGVmYXVsdFRheCA9IE1hZ2U6OmdldFNpbmdsZXRvbigndGF4L2NhbGN1bGF0aW9uJyktPmdldFJhdGUoJF9yZXF1ZXN0KTsgJF9yZXF1ZXN0ID0gTWFnZTo6Z2V0U2luZ2xldG9uKCd0YXgvY2FsY3VsYXRpb24nKS0+Z2V0UmF0ZVJlcXVlc3QoKTsgJF9yZXF1ZXN0LT5zZXRQcm9kdWN0Q2xhc3NJZCgkcHJvZHVjdC0+Z2V0VGF4Q2xhc3NJZCgpKTsgJGN1cnJlbnRUYXggPSBNYWdlOjpnZXRTaW5nbGV0b24oJ3RheC9jYWxjdWxhdGlvbicpLT5nZXRSYXRlKCRfcmVxdWVzdCk7ICRfcmVndWxhclByaWNlID0gJHByb2R1Y3QtPmdldFByaWNlKCk7ICRfZmluYWxQcmljZSA9ICRwcm9kdWN0LT5nZXRGaW5hbFByaWNlKCk7ICRfcHJpY2VJbmNsVGF4ID0gTWFnZTo6aGVscGVyKCd0YXgnKS0+Z2V0UHJpY2UoJHByb2R1Y3QsICRfZmluYWxQcmljZSwgdHJ1ZSk7ICRfcHJpY2VFeGNsVGF4ID0gTWFnZTo6aGVscGVyKCd0YXgnKS0+Z2V0UHJpY2UoJHByb2R1Y3QsICRfZmluYWxQcmljZSk7ICRfdGllclByaWNlcyA9IGFycmF5KCk7ICRfdGllclByaWNlc0luY2xUYXggPSBhcnJheSgpOyBmb3JlYWNoICgkcHJvZHVjdC0+Z2V0VGllclByaWNlKCkgYXMgJHRpZXJQcmljZSkgeyAkX3RpZXJQcmljZXNbXSA9IE1hZ2U6OmhlbHBlcignY29yZScpLT5jdXJyZW5jeSgkdGllclByaWNlWyd3ZWJzaXRlX3ByaWNlJ10sIGZhbHNlLCBmYWxzZSk7ICRfdGllclByaWNlc0luY2xUYXhbXSA9IE1hZ2U6OmhlbHBlcignY29yZScpLT5jdXJyZW5jeSggTWFnZTo6aGVscGVyKCd0YXgnKS0+Z2V0UHJpY2UoJHByb2R1Y3QsIChpbnQpJHRpZXJQcmljZVsnd2Vic2l0ZV9wcmljZSddLCB0cnVlKSwgZmFsc2UsIGZhbHNlKTsgfSAkY29uZmlnID0gYXJyYXkoICdwcm9kdWN0SWQnID0+ICRwcm9kdWN0LT5nZXRJZCgpLCAncHJpY2VGb3JtYXQnID0+IE1hZ2U6OmFwcCgpLT5nZXRMb2NhbGUoKS0+Z2V0SnNQcmljZUZvcm1hdCgpLCAnaW5jbHVkZVRheCcgPT4gTWFnZTo6aGVscGVyKCd0YXgnKS0+cHJpY2VJbmNsdWRlc1RheCgpID8gJ3RydWUnIDogJ2ZhbHNlJywgJ3Nob3dJbmNsdWRlVGF4JyA9PiBNYWdlOjpoZWxwZXIoJ3RheCcpLT5kaXNwbGF5UHJpY2VJbmNsdWRpbmdUYXgoKSwgJ3Nob3dCb3RoUHJpY2VzJyA9PiBNYWdlOjpoZWxwZXIoJ3RheCcpLT5kaXNwbGF5Qm90aFByaWNlcygpLCAncHJvZHVjdFByaWNlJyA9PiBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+Y3VycmVuY3koJF9maW5hbFByaWNlLCBmYWxzZSwgZmFsc2UpLCAncHJvZHVjdE9sZFByaWNlJyA9PiBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+Y3VycmVuY3koJF9yZWd1bGFyUHJpY2UsIGZhbHNlLCBmYWxzZSksICdwcmljZUluY2xUYXgnID0+IE1hZ2U6OmhlbHBlcignY29yZScpLT5jdXJyZW5jeSgkX3ByaWNlSW5jbFRheCwgZmFsc2UsIGZhbHNlKSwgJ3ByaWNlRXhjbFRheCcgPT4gTWFnZTo6aGVscGVyKCdjb3JlJyktPmN1cnJlbmN5KCRfcHJpY2VFeGNsVGF4LCBmYWxzZSwgZmFsc2UpLCAvKiogKiBAdmFyIHNraXBDYWxjdWxhdGUgKiBAZGVwcmVjYXRlZCBhZnRlciAxLjUuMS4wICovICdza2lwQ2FsY3VsYXRlJyA9PiAoJF9wcmljZUV4Y2xUYXggIT0gJF9wcmljZUluY2xUYXggPyAwIDogMSksICdkZWZhdWx0VGF4JyA9PiAkZGVmYXVsdFRheCwgJ2N1cnJlbnRUYXgnID0+ICRjdXJyZW50VGF4LCAnaWRTdWZmaXgnID0+ICdfY2xvbmUnLCAnb2xkUGx1c0Rpc3Bvc2l0aW9uJyA9PiAwLCAncGx1c0Rpc3Bvc2l0aW9uJyA9PiAwLCAncGx1c0Rpc3Bvc2l0aW9uVGF4JyA9PiAwLCAnb2xkTWludXNEaXNwb3NpdGlvbicgPT4gMCwgJ21pbnVzRGlzcG9zaXRpb24nID0+IDAsICd0aWVyUHJpY2VzJyA9PiAkX3RpZXJQcmljZXMsICd0aWVyUHJpY2VzSW5jbFRheCcgPT4gJF90aWVyUHJpY2VzSW5jbFRheCwgKTsgJHJlc3BvbnNlT2JqZWN0ID0gbmV3IFZhcmllbl9PYmplY3QoKTsgTWFnZTo6ZGlzcGF0Y2hFdmVudCgnY2F0YWxvZ19wcm9kdWN0X3ZpZXdfY29uZmlnJywgYXJyYXkoJ3Jlc3BvbnNlX29iamVjdCc9PiRyZXNwb25zZU9iamVjdCkpOyBpZiAoaXNfYXJyYXkoJHJlc3BvbnNlT2JqZWN0LT5nZXRBZGRpdGlvbmFsT3B0aW9ucygpKSkgeyBmb3JlYWNoICgkcmVzcG9uc2VPYmplY3QtPmdldEFkZGl0aW9uYWxPcHRpb25zKCkgYXMgJG9wdGlvbj0+JHZhbHVlKSB7ICRjb25maWdbJG9wdGlvbl0gPSAkdmFsdWU7IH0gfSByZXR1cm4gJGNvbmZpZzsgfSBwdWJsaWMgZnVuY3Rpb24gZm9ybWF0RmlsZU5hbWUoJGZpbGUpIHsgJGZvcm1hdFJlc3VsdCA9IE1hZ2U6OmhlbHBlcignY2F0YWxvZy9wcm9kdWN0X3VybCcpLT5mb3JtYXQoJGZpbGUpOyByZXR1cm4gcHJlZ19yZXBsYWNlKCcjW1xzXSsjaScsICctJywgJGZvcm1hdFJlc3VsdCk7IH0gcHVibGljIGZ1bmN0aW9uIGNhbkFwcGx5TXNycCgkcHJvZHVjdCwgJHZpc2liaWxpdHkgPSBudWxsLCAkY2hlY2tBc3NvY2lhdGVkSXRlbXMgPSB0cnVlKSB7ICR2ZXJzaW9uID0gTWFnZTo6Z2V0VmVyc2lvbkluZm8oKTsgaWYgKCgkdmVyc2lvblsnbWFqb3InXSA9PT0gJzEnKSAmJiAoKGludCkgJHZlcnNpb25bJ21pbm9yJ10gPD0gNSkpIHsgcmV0dXJuIGZhbHNlOyB9IGVsc2VpZiAobWV0aG9kX2V4aXN0cyhNYWdlOjpoZWxwZXIoJ2NhdGFsb2cnKSwgJ2NhbkFwcGx5TXNycCcpKSB7IHJldHVybiBNYWdlOjpoZWxwZXIoJ2NhdGFsb2cnKS0+Y2FuQXBwbHlNc3JwKCRwcm9kdWN0LCAkdmlzaWJpbGl0eSwgJGNoZWNrQXNzb2NpYXRlZEl0ZW1zKTsgfSByZXR1cm4gZmFsc2U7IH0gLyoqICogUmV0cmlldmUgdXJsIGZvciBhZGRpbmcgcHJvZHVjdCB0byB3aXNobGlzdCAqICogQHBhcmFtIGludCAkaXRlbUlkICogKiBAcmV0dXJuIHN0cmluZyAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0TW92ZUZyb21DYXJ0VXJsKCRpdGVtSWQpIHsgJHZlcnNpb24gPSBNYWdlOjpnZXRWZXJzaW9uSW5mbygpOyBpZiAoKCR2ZXJzaW9uWydtYWpvciddID09PSAnMScpICYmICgoaW50KSAkdmVyc2lvblsnbWlub3InXSA8PSA1KSkgeyByZXR1cm4gZmFsc2U7IH0gZWxzZSBpZiAobWV0aG9kX2V4aXN0cyhNYWdlOjpoZWxwZXIoJ3dpc2hsaXN0JyksICdnZXRNb3ZlRnJvbUNhcnRVcmwnKSkgeyByZXR1cm4gTWFnZTo6aGVscGVyKCd3aXNobGlzdCcpLT5nZXRNb3ZlRnJvbUNhcnRVcmwoJGl0ZW1JZCk7IH0gcmV0dXJuIGZhbHNlOyB9IC8qKiAqIEdldCBKU09OIGVuY29kZWQgY29uZmlndXJhdGlvbiBhcnJheSB3aGljaCBjYW4gYmUgdXNlZCBmb3IgSlMgZHluYW1pYyAqICogQHJldHVybiBzdHJpbmcgKi8gcHVibGljIGZ1bmN0aW9uIGdldFByb2R1Y3RQcmljZUNvbmZpZ0pzb24oKSB7IHJldHVybiBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+anNvbkVuY29kZSgkdGhpcy0+Z2V0UHJvZHVjdFByaWNlQ29uZmlnKCkpOyB9IC8qKiAqIFJldHVybiBwcm9kdWN0IGRlc2lnbiBmcm9tIHJlcXVlc3QgKiAqIEBwYXJhbSBNYWdlX0NhdGFsb2dfTW9kZWxfUHJvZHVjdCAkcHJvZHVjdCBQcm9kdWN0ICogQHJldHVybiBib29sfE1hZ2VfQ29yZV9Nb2RlbF9BYnN0cmFjdCAqLyBwdWJsaWMgZnVuY3Rpb24gZ2V0UHJvZHVjdERlc2lnbigkcHJvZHVjdCkgeyBpZiAoaXNfbnVsbCgkdGhpcy0+X3Byb2R1Y3REZXNpZ24pKSB7ICRkZXNpZ25JZCA9IChpbnQpIE1hZ2U6OmFwcCgpLT5nZXRSZXF1ZXN0KCktPmdldFBhcmFtKCdkZXNpZ25faWQnLCBmYWxzZSk7IGlmICgkZGVzaWduSWQpIHsgJGRlc2lnbiA9IE1hZ2U6OmdldE1vZGVsKCdnb21hZ2VfZGVzaWduZXIvZGVzaWduJyktPmxvYWQoJGRlc2lnbklkKTsgaWYgKCRkZXNpZ24tPmdldElkKCkgJiYgJGRlc2lnbi0+Z2V0UHJvZHVjdElkKCkgPT0gJHByb2R1Y3QtPmdldElkKCkpIHsgJHRoaXMtPl9wcm9kdWN0RGVzaWduID0gJGRlc2lnbjsgfSBlbHNlIHsgJHRoaXMtPl9wcm9kdWN0RGVzaWduID0gZmFsc2U7IH0gfSB9IHJldHVybiAkdGhpcy0+X3Byb2R1Y3REZXNpZ247IH0gcHVibGljIGZ1bmN0aW9uIGdldEFsbFN0b3JlRG9tYWlucygpeyAkZG9tYWlucyA9IGFycmF5KCk7IGZvcmVhY2ggKE1hZ2U6OmFwcCgpLT5nZXRXZWJzaXRlcygpIGFzICR3ZWJzaXRlKSB7ICR1cmwgPSAkd2Vic2l0ZS0+Z2V0Q29uZmlnKCd3ZWIvdW5zZWN1cmUvYmFzZV91cmwnKTsgaWYoJGRvbWFpbiA9IHRyaW0ocHJlZ19yZXBsYWNlKCcvXi4qP1xcL1xcLyguKik/XFwvLycsICckMScsICR1cmwpKSkgeyAkZG9tYWluc1tdID0gJGRvbWFpbjsgfSAkdXJsID0gJHdlYnNpdGUtPmdldENvbmZpZygnd2ViL3NlY3VyZS9iYXNlX3VybCcpOyBpZiAoJGRvbWFpbiA9IHRyaW0ocHJlZ19yZXBsYWNlKCcvXi4qP1xcL1xcLyguKik/XFwvLycsICckMScsICR1cmwpKSkgeyAkZG9tYWluc1tdID0gJGRvbWFpbjsgfSB9IHJldHVybiBhcnJheV91bmlxdWUoJGRvbWFpbnMpOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXRXaW5kb3dDc3NQYXRoKCkgeyBpZighJHRoaXMtPmdldElzQW55bW9yZVZlcnNpb24oMSwgNykpIHsgcmV0dXJuICdwcm90b3R5cGUvd2luZG93cy90aGVtZXMvbWFnZW50by5jc3MnOyB9IGVsc2UgeyByZXR1cm4gJ2xpYi9wcm90b3R5cGUvd2luZG93cy90aGVtZXMvbWFnZW50by5jc3MnOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldENzc1R5cGUoKSB7IGlmKCEkdGhpcy0+Z2V0SXNBbnltb3JlVmVyc2lvbigxLCA3KSkgeyByZXR1cm4gJ2pzX2Nzcyc7IH0gZWxzZSB7IHJldHVybiAnc2tpbl9jc3MnOyB9IH0gcHVibGljIGZ1bmN0aW9uIGdldEF2YWlsYWJsZVdlYnNpdGVzKCkgeyByZXR1cm4gJHRoaXMtPl93KCk7IH0gcHJvdGVjdGVkIGZ1bmN0aW9uIF93KCkgeyBpZighTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2luc3RhbGxlZCcpIHx8IChpbnR2YWwoTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2NvdW50JykpID4gMTApKSB7IHJldHVybiBhcnJheSgpOyB9ICR0aW1lX3RvX3VwZGF0ZSA9IDYwKjYwKjI0KjE1OyAkciA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci9hcicpOyAkdCA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci90aW1lJyk7ICRzID0gTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL3dlYnNpdGVzJyk7ICRsYXN0X2NoZWNrID0gc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkdCkpOyAkYWxsc2l0ZXMgPSBleHBsb2RlKCcsJywgc3RyX3JlcGxhY2UoJHIsICcnLCBNYWdlOjpoZWxwZXIoJ2NvcmUnKS0+ZGVjcnlwdCgkcykpKTsgJGFsbHNpdGVzID0gYXJyYXlfZGlmZigkYWxsc2l0ZXMsIGFycmF5KCIiKSk7IGlmKCgkbGFzdF9jaGVjayskdGltZV90b191cGRhdGUpIDwgdGltZSgpKXsgJHRoaXMtPmEoTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2tleScpLCBpbnR2YWwoTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2NvdW50JykpLCBpbXBsb2RlKCcsJywgJGFsbHNpdGVzKSk7IH0gcmV0dXJuICRhbGxzaXRlczsgfSBwdWJsaWMgZnVuY3Rpb24gYSgkaywgJGMgPSAwLCAkcyA9ICcnKSB7ICRjaCA9IGN1cmxfaW5pdCgpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCBzcHJpbnRmKCdodHRwczovL3d3dy5nb21hZ2UuY29tL2luZGV4LnBocC9nb21hZ2VfZG93bmxvYWRhYmxlL2tleS9jaGVjaycpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJ2tleT0nLnVybGVuY29kZSgkaykuJyZza3U9cHJvZHVjdC1kZXNpZ25lciZkb21haW5zPScudXJsZW5jb2RlKGltcGxvZGUoJywnLCAkdGhpcy0+Z2V0QWxsU3RvcmVEb21haW5zKCkpKS4nJnZlcj0nLnVybGVuY29kZSgnMS4wJykpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVElNRU9VVCwgMzApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUkVUVVJOVFJBTlNGRVIsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWUhPU1QsIDApOyAkY29udGVudCA9IGN1cmxfZXhlYygkY2gpOyAkciA9IFplbmRfSnNvbjo6ZGVjb2RlKCRjb250ZW50KTsgJGUgPSBNYWdlOjpoZWxwZXIoJ2NvcmUnKTsgaWYoZW1wdHkoJHIpKXsgJHZhbHVlMSA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci9hcicpOyAkZ3JvdXBzID0gYXJyYXkoICdkZXNpZ25lcic9PmFycmF5KCAnZmllbGRzJz0+YXJyYXkoICdhcic9PmFycmF5KCAndmFsdWUnPT4kdmFsdWUxICksICd3ZWJzaXRlcyc9PmFycmF5KCAndmFsdWUnPT4oc3RyaW5nKU1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci93ZWJzaXRlcycpICksICd0aW1lJz0+YXJyYXkoICd2YWx1ZSc9PihzdHJpbmcpJGUtPmVuY3J5cHQoJHZhbHVlMS4odGltZSgpLSg2MCo2MCoyNCoxNS0xODAwKSkuJHZhbHVlMSkgKSwgJ2NvdW50Jz0+YXJyYXkoICd2YWx1ZSc9PiRjKzEpICkgKSApOyBNYWdlOjpnZXRNb2RlbCgnYWRtaW5odG1sL2NvbmZpZ19kYXRhJykgLT5zZXRTZWN0aW9uKCdnb21hZ2VfYWN0aXZhdGlvbicpIC0+c2V0R3JvdXBzKCRncm91cHMpIC0+c2F2ZSgpOyBNYWdlOjpnZXRDb25maWcoKS0+cmVpbml0KCk7IE1hZ2U6OmFwcCgpLT5yZWluaXRTdG9yZXMoKTsgcmV0dXJuOyB9ICR2YWx1ZTEgPSAnJzsgJHZhbHVlMiA9ICcnOyBpZihpc3NldCgkclsnZCddKSAmJiBpc3NldCgkclsnYyddKSl7ICR2YWx1ZTEgPSAkZS0+ZW5jcnlwdChiYXNlNjRfZW5jb2RlKFplbmRfSnNvbjo6ZW5jb2RlKCRyKSkpOyBpZiAoISRzKSAkcyA9IE1hZ2U6OmdldFN0b3JlQ29uZmlnKCdnb21hZ2VfYWN0aXZhdGlvbi9kZXNpZ25lci93ZWJzaXRlcycpOyAkcyA9IGFycmF5X3NsaWNlKGV4cGxvZGUoJywnLCAkcyksIDAsICRyWydjJ10pOyAkdmFsdWUyID0gJGUtPmVuY3J5cHQoJHZhbHVlMS5pbXBsb2RlKCcsJywgJHMpLiR2YWx1ZTEpOyB9ICRncm91cHMgPSBhcnJheSggJ2Rlc2lnbmVyJz0+YXJyYXkoICdmaWVsZHMnPT5hcnJheSggJ2FyJz0+YXJyYXkoICd2YWx1ZSc9PiR2YWx1ZTEgKSwgJ3dlYnNpdGVzJz0+YXJyYXkoICd2YWx1ZSc9PihzdHJpbmcpJHZhbHVlMiApLCAndGltZSc9PmFycmF5KCAndmFsdWUnPT4oc3RyaW5nKSRlLT5lbmNyeXB0KCR2YWx1ZTEudGltZSgpLiR2YWx1ZTEpICksICdpbnN0YWxsZWQnPT5hcnJheSggJ3ZhbHVlJz0+MSApLCAnY291bnQnPT5hcnJheSggJ3ZhbHVlJz0+MCkgKSApICk7IE1hZ2U6OmdldE1vZGVsKCdhZG1pbmh0bWwvY29uZmlnX2RhdGEnKSAtPnNldFNlY3Rpb24oJ2dvbWFnZV9hY3RpdmF0aW9uJykgLT5zZXRHcm91cHMoJGdyb3VwcykgLT5zYXZlKCk7IE1hZ2U6OmdldENvbmZpZygpLT5yZWluaXQoKTsgTWFnZTo6YXBwKCktPnJlaW5pdFN0b3JlcygpOyB9IHB1YmxpYyBmdW5jdGlvbiBnYSgpIHsgcmV0dXJuIFplbmRfSnNvbjo6ZGVjb2RlKGJhc2U2NF9kZWNvZGUoTWFnZTo6aGVscGVyKCdjb3JlJyktPmRlY3J5cHQoTWFnZTo6Z2V0U3RvcmVDb25maWcoJ2dvbWFnZV9hY3RpdmF0aW9uL2Rlc2lnbmVyL2FyJykpKSk7IH0gcHVibGljIGZ1bmN0aW9uIG5vdGlmeSgpIHsgJGZyZXF1ZW5jeSA9IGludHZhbChNYWdlOjphcHAoKS0+bG9hZENhY2hlKCdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKSk7IGlmICghJGZyZXF1ZW5jeSl7ICRmcmVxdWVuY3kgPSAyNDsgfSAkbGFzdF91cGRhdGUgPSBpbnR2YWwoTWFnZTo6YXBwKCktPmxvYWRDYWNoZSgnZ29tYWdlX25vdGlmaWNhdGlvbnNfbGFzdF91cGRhdGUnKSk7IGlmICgoJGZyZXF1ZW5jeSAqIDYwICogNjAgKyAkbGFzdF91cGRhdGUpID4gdGltZSgpKSB7IHJldHVybiBmYWxzZTsgfSAkdGltZXN0YW1wID0gJGxhc3RfdXBkYXRlOyBpZiAoISR0aW1lc3RhbXApeyAkdGltZXN0YW1wID0gdGltZSgpOyB9IHRyeXsgJGNoID0gY3VybF9pbml0KCk7IGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VUkwsIHNwcmludGYoJ2h0dHBzOi8vd3d3LmdvbWFnZS5jb20vaW5kZXgucGhwL2dvbWFnZV9ub3RpZmljYXRpb24vaW5kZXgvZGF0YScpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BPU1QsIHRydWUpOyBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfUE9TVEZJRUxEUywgJ3NrdT1wcm9kdWN0LWRlc2lnbmVyJnRpbWVzdGFtcD0nLiR0aW1lc3RhbXAuJyZ2ZXI9Jy51cmxlbmNvZGUoJzEuMCcpKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1RJTUVPVVQsIDMwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllQRUVSLCAwKTsgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1NTTF9WRVJJRllIT1NULCAwKTsgJGNvbnRlbnQgPSBjdXJsX2V4ZWMoJGNoKTsgJHJlc3VsdCA9IFplbmRfSnNvbjo6ZGVjb2RlKCRjb250ZW50KTsgaWYgKCRyZXN1bHQgJiYgaXNzZXQoJHJlc3VsdFsnZnJlcXVlbmN5J10pICYmICgkcmVzdWx0WydmcmVxdWVuY3knXSAhPSAkZnJlcXVlbmN5KSl7IE1hZ2U6OmFwcCgpLT5zYXZlQ2FjaGUoJHJlc3VsdFsnZnJlcXVlbmN5J10sICdnb21hZ2Vfbm90aWZpY2F0aW9uc19mcmVxdWVuY3knKTsgfSBpZiAoJHJlc3VsdCAmJiBpc3NldCgkcmVzdWx0WydkYXRhJ10pKXsgaWYgKCFlbXB0eSgkcmVzdWx0WydkYXRhJ10pKXsgTWFnZTo6Z2V0TW9kZWwoJ2FkbWlubm90aWZpY2F0aW9uL2luYm94JyktPnBhcnNlKCRyZXN1bHRbJ2RhdGEnXSk7IH0gfSB9IGNhdGNoIChFeGNlcHRpb24gJGUpe30gTWFnZTo6YXBwKCktPnNhdmVDYWNoZSh0aW1lKCksICdnb21hZ2Vfbm90aWZpY2F0aW9uc19sYXN0X3VwZGF0ZScpOyB9IH0="));